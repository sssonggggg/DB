---------------------------------------------------------------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------------------------------------------------------------
---------------SQL작성기본규칙-----------------------------------------------------------------------------------------------------------------------
---------------
--------------- SELECT
---------------   NAME
--------------- , AGE
--------------- , HEIGHT
--------------- FROM USER     줄간격띄우지않기 매쿼리(서브쿼리도)마다 주석작성하고 주석위치맞춰주기!!
--------------- INNER JOIN ~~~~ AS B ON B. 먼저써주기
---------------  JOIN걸때도 키체크
---------------  WHERE 조건쓸때 테이블의 키갯수를 꼭 체크.. F12눌러서 어떤값이넘어오는지도 체크
---------------  띄어쓸때 탭 노노 스페이스바 오키 띄워
--------------- (A = 'B' OR A = 'C') 한칸씩띄어주기!! AND 나 OR 쓸때는()묶어주기기
---------------------------------------------------------------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------------------------------------------------------------



-----------------------------------------------------권한관리조회------------------------------------------------------------------------------------
--권한코드,권한명,권한설명,사용여부
SELECT
      A.ROLEID      --권한코드
    , A.ROLENM      -- ,권한명
    , A.REM         -- ,권한설명
    , A.USEYN       -- ,용여부

FROM COR_ROLE_M as A    --49
WHERE 1=1
AND (ROLEID = 'B1000' OR A.ROLENM LIKE '%교원%')
AND USEYN = 'Y'






-----------------------------------------------------권한관리신규-------------------------------------------------------------------------------------
--권한코드,권한명,권한설명,사용여부,작성일,작성자
--DECLARE @MAXNUM  INT
--SELECT @MAXNUM = ISNULL(MAX(RIGHT( ROLEID, CHARINDEX('0', ROLEID )-1)),0)+1  FROM COR_ROLE_M WHERE ROLEID LIKE 'VV%'
--SELECT @ROLEIDD = 'VV' + CAST((SELECT FORMAT(@MAXNUM, 'D3')) AS varchar)

DECLARE @ROLEIDDD VARCHAR(5)
SELECT @ROLEIDDD = 'VV' + CAST((SELECT FORMAT(ISNULL(MAX(RIGHT( ROLEID, CHARINDEX('0', ROLEID )-1)),0)+1  , 'D3')) AS varchar) FROM COR_ROLE_M WHERE ROLEID LIKE 'VV%'

--SELECT CHARINDEX('0', 'HJ008' ) --3
--SELECT RIGHT('HJ008', CHARINDEX('0', 'HJ008' )-1)
--SELECT MAX(RIGHT('HJ008', CHARINDEX('0', 'HJ008' )-1))
--SELECT MAX(RIGHT('HJ008', CHARINDEX('0', 'HJ008' )-1))
--SELECT ISNULL(MAX(RIGHT('HJ008', CHARINDEX('0', 'HJ008' )-1)),0)+1

insert into COR_ROLE_M
    (
      ROLEID        --권한코드
    , ROLENM        -- ,권한명
    , REM           -- ,권한설명
    , USEYN         -- ,사용여부
    , INDT          -- ,작성일시
    , INUSER        -- ,작성자
    )
VALUES (
         @ROLEIDDD
        ,'사장'
        ,'시스템사용권한'
        ,'Y'
        ,GETDATE()
        ,'admin'
        )




--------------------------------------------------------------권한관리수정------------------------------------------------------------
UPDATE COR_ROLE_M SET
      ROLENM     ='부사장'
    , REM        ='임시'
    , USEYN      ='N'
    , UPDT       =getdate()
    , UPUSER     ='admin_g'

WHERE 1=1
AND ROLEID='ZZ001'







-----------------------------------------------------------------권한관리삭제-----------------------------------------------------------
DELETE COR_ROLE_M
WHERE 1=1
AND ROLEID='ZZ001'






-----------------------------------------------------------교원별관리학과지정조회(사용자)--------------------------------------------------
--사용자ID,성명,생년월일,사용자구분,사용여부
SELECT
      A.USERID      -- 사용자ID
    , A.USERNM      -- 성명
    , A.JUMIN1      -- 생년월일
    , B.CODENAME AS USERGBNM    -- 사용자구분명
    , A.SAYONGYN    -- 사용여부

FROM COR_USER_M AS A    --6695
INNER JOIN COR_BASECODE_M AS B ON B.GROUPCODE='COR43' AND B.SUBCODE = A.USERGB   --6695
WHERE A.USERGB = '1' OR A.USERGB = '3'  --296
AND (A.USERID = '0363' OR A.USERNM = '오%')




---------------------------------------------------------교원별관리학과지정조회(관리학과)-----------------------------------------------------
--사용자ID,성명,생년월일,사용자구분,학과코드,학과명
SELECT
      A.SABEON                  --사용자ID,
    , B.USERID
    , B.USERNM                    -- ,성명
    , B.JUMIN1                  -- ,생년월일
    , D.CODENAME AS USERGBNM     -- ,사용자구분
    , A.SOSOGCD                 -- ,학과코드
    , C.SOSOGNM AS HAGGWA       -- ,학과명

FROM COR_USERSOSOGCD_M AS A --1434
LEFT JOIN COR_USER_M AS B ON B.USERID=A.SABEON  --1434
LEFT JOIN COR_SOSOGCD_M AS C ON C.SOSOGCD = A.SOSOGCD   --1434
LEFT JOIN COR_BASECODE_M AS D ON D.GROUPCODE='COR43' AND D.SUBCODE = B.USERGB   --1434
WHERE 1=1
AND A.SABEON = '0363'
AND C.SOSOGCD = '110'







-------------------------------------------------------------교원별관리학과지정신규----------------------------------------------------------
INSERT INTO COR_USERSOSOGCD_M
    (
      SABEON
    , SOSOGCD
    , INDT
    , INUSER
    )
VALUES
    (
      '0365'
    , '200'
    , getdate()
    , 'admin'
    )





-------------------------------------------------------------교원별관리학과지정삭제-----------------------------------------------------------
DELETE COR_USERSOSOGCD_M
WHERE 1=1
AND SABEON='0363'
AND SOSOGCD='100'






-----------------------------------------------------------------사용자관리조회--------------------------------------------------------------------------
--사용ID,성명,생년월일,사용자구분,사번/학번,질문구분,답변,사용여부,암호변경일,암호초기화여부
--SELECT * FROM COR_USER_M
SELECT
      A.USERID                                          --사용ID
    , A.USERNM                                          -- ,성명
    , A.JUMIN1                                          -- ,생년월일
    , C.CODENAME   AS USERGBNM                          -- ,사용자구분
    , A.LINKKEY                                         -- ,사번/학번
    , B.CODENAME   AS JILMUNGBNM                        -- ,질문구분
    , A.DABBYEON                                        -- ,답변
    , A.SAYONGYN                                        -- ,사용여부
    , CONVERT(VARCHAR, A.PWDUPDT, 120) AS PWUPDT        -- ,암호변경일
    , A.PWDINITYN                                       -- ,암호초기화여부

FROM COR_USER_M A   --6695
LEFT JOIN COR_BASECODE_M B ON B.GROUPCODE = 'COR60' AND B.SUBCODE = A.JILMUNGB  --6695
INNER JOIN COR_BASECODE_M C ON C.GROUPCODE = 'COR43' AND C.SUBCODE = A.USERGB    --6695

WHERE 1=1
AND (A.USERID = '0099' OR A.USERNM LIKE '김%')
AND A.USERGB='1'



-----------------------------------------------------------------사용자관리신규-------------------------------------------------------------------------
INSERT INTO COR_USER_M
    (
      USERID
    , USERNM
    , PASENCY
    , JUMIN1
    , SAYONGYN
    , USERGB
    , JILMUNGB
    , DABBYEON
    , SOSOGCD
    , LINKKEY
    , PWDINITYN
    , INDT
    , INUSER
    )
  VALUES
    (
      '6788'
    , '송나겸'
    , pwdencrypt('7645')
    , '000000'
    , 'Y'
    , '1'
    , 'OO'
    , '우리대학'
    , '200'
    , '084021'
    , 'Y'
    , GETDATE()
     , 'admin'
    )

------------------------------------------------------------------사용자관리수정---------------------------------------------------------------------
UPDATE COR_USER_M SET
      USERNM         ='여유선'
    , JUMIN1         ='000001'
    , SAYONGYN       ='N'
    , USERGB         ='2'
    , JILMUNGB       ='03'
    , DABBYEON       ='우리대학2'
    , SOSOGCD        ='100'
    , PWDUPDT        =GETDATE()
    , UPDT           =GETDATE()
    , UPUSER         ='admin2'

WHERE 1=1
AND USERID= '9999'




-----------------------------------------------------------------사용자관리삭제--------------------------------------------------------------------
DELETE COR_USER_M
WHERE 1=1
AND USERID= '0099'





-------------------------------------------------------------------패스워드초기화-------------------------------------------------
--비밀번호암호화필요
UPDATE COR_USER_M SET
      PASENCY        =pwdencrypt('3241')
    , PWDUPDT        =GETDATE()
    , PWDINITYN      ='Y'

WHERE 1=1
AND USERID= '9999'




-----------------------------------------------------------------상벌관리목록조회--------------------------------------------------------------------------
--학년도,학기,학번,성명,학과,상벌일,상벌구분,상벌점,상점계,벌점계,누계
SELECT
      A.YY                                                              --학년도
    , A.HAGGI                                                           -- ,학기
    , A.HAGBEON                                                         -- ,학번
    , B.NM                                                              -- ,성명
    , C.SOSOGNM AS HAGGWA                                               -- ,학과
    , CONVERT(CHAR(10), CONVERT (DATE,A.SANGBEOLDT ), 23)as SANGBEOLDT  -- ,상벌일
    , D.CODENAME AS SANGBEOLGBNM                                        -- ,상벌구분명
    , A.JEOMSU                                                          -- ,상벌점
    , E.SANGJEOM-- ,상점계
    , E.BELJEOM-- ,벌점계
    , E.TOTAL-- ,누계

FROM SHS_SANGBEOL_M AS A     --8023
INNER JOIN SHJ_HAGJEOG_M B on  B.HAGBEON = A.HAGBEON     --8023
LEFT JOIN COR_SOSOGCD_M C ON C.SOSOGCD = B.SOSOGCD      --8023
LEFT JOIN COR_BASECODE_M D ON D.GROUPCODE = 'SHJ10' AND D.SUBCODE = A.SANGBEOLGB    --8023
INNER JOIN
    (
    SELECT
      A.YY                                                                                  -- ,학년도
    , A.HAGGI                                                                               -- ,학기
    , A.HAGBEON                                                                             -- ,학번
    , SUM(CASE WHEN (CONVERT(INT, A.JEOMSU)) > 0 THEN A.JEOMSU ELSE 0 END) AS SANGJEOM      -- ,상점계
    , SUM(CASE WHEN (CONVERT(INT, A.JEOMSU)) < 0 THEN A.JEOMSU ELSE 0 END) AS BELJEOM       -- ,벌점계
    , SUM((CONVERT(INT, A.JEOMSU))) AS TOTAL                                                -- ,누계
    FROM SHS_SANGBEOL_M AS A
    GROUP BY  A.YY , A.HAGGI , A.HAGBEON
    ) AS E ON E.HAGBEON = A.HAGBEON AND E.YY = A.YY AND E.HAGGI = A.HAGGI     --8023
WHERE 1=1
AND A.YY='2018'
AND A.HAGGI='2'
AND (A.HAGBEON='201411148' OR B.NM='%연%' )
AND A.SANGBEOLGB='99'


--SELECT * FROM COR_BASECODE_M WHERE GROUPCODE='COR08'





--------------------------------------------------------------상벌관리목록신규-------------------------------------------------------------------------
--GETDATE에서년,월,일추출하기
DECLARE @SEQ  INT
DECLARE @YY Year
DECLARE @HAG Code
SELECT @YY=CONVERT(VARCHAR(4), DATEPART(YEAR,GETDATE()))
SELECT @HAG=(CASE WHEN CONVERT(INT, DATEPART(MONTH,GETDATE())) BETWEEN 3 AND 6 THEN '1'
                  WHEN CONVERT(INT, DATEPART(MONTH,GETDATE())) BETWEEN 7 AND 8 THEN 'S'
                  WHEN CONVERT(INT, DATEPART(MONTH,GETDATE())) BETWEEN 9 AND 12 THEN '2'
                  ELSE 'W'
             END)
--자동일련번호
SELECT @SEQ = ISNULL(MAX(SEQ),0) + 1 FROM SHS_SANGBEOL_M WHERE 1=1 AND YY=@YY AND HAGGI=@HAG AND HAGBEON='201411148'
INSERT INTO  SHS_SANGBEOL_M
    (
      YY                    --학년도
    , HAGGI                 -- ,학기
    , HAGBEON               -- ,학번
    , SANGBEOLDT            -- ,상벌일
    , SANGBEOLGB            -- ,상벌구분
    , JEOMSU                -- ,상벌점
    , SEBUNAEYONG           -- ,세부내용
    , INUSER                -- ,입력자
    , INDT                  -- ,입력시간
    , SEQ                   -- ,일련번호
    )
VALUES
    (
      @YY
    , @HAG
    , '201411148'
    , '20210716'
    , '99'
    , '3'
    , '전년도이월점수'
    , '0407'
    , GETDATE()
    , @SEQ
    )

-------------------------------------------------------------------상벌관리목록수정------------------------------------------------------------------
UPDATE SHS_SANGBEOL_M  SET
      SANGBEOLDT   = '20210716'     -- ,상벌일
    , SANGBEOLGB   = '54'           -- ,상벌구분
    , JEOMSU       = '2'            -- ,상벌점
    , SEBUNAEYONG  = 'MT참여'        -- ,세부내용
    , UPUSER       = '0407'         -- ,수정자
    , UPDT         = GETDATE()      -- ,수정시간

WHERE 1=1
AND (HAGGI='1')
AND (YY='2021')
AND (HAGBEON = '201411148')
AND (SEQ='6')

-------------------------------------------------------------------상벌관리목록삭제----------------------------------------------------------------
DELETE SHS_SANGBEOL_M
WHERE 1=1
AND YY='2021'
AND HAGGI='1'
AND HAGBEON='201411148'
AND SEQ='6'


---------------------------------------------------------시스템지원관리목록조회------------------------------------------------------------------------
-- 요청일,요청자,프로그램명,요청내용,상태,처리내용,처리일,처리자

SELECT
  A.REQUESTSEQ
, A.REQUESTDT
, CONVERT(CHAR(10), CONVERT (DATE, A.REQUESTDT )) AS REQUESTDT                                                                -- 요청일
, A.REQUESTUSER                                                                                                               -- 요청자
, B.PROGRAMNM                                                                                                                 -- 프로그램명
, A.REQUESTDESC                                                                                                               -- 요청내용
, (CASE WHEN A.SUPPORTDT != '' AND A.SUPPORTDT IS NOT NULL THEN '완료' ELSE '요청' END )  AS 상태                                -- 처리상태
, A.SUPPORTDESC                                                                                                               -- 처리내용
, (CASE WHEN A.SUPPORTDT != '' AND A.SUPPORTDT IS NOT NULL THEN CONVERT(CHAR(10), CONVERT (DATE, A.SUPPORTDT )) ELSE ''
    END) AS SUPPORTDT
, A.SUPPORTUSER                                                                                                               -- 처리자
FROM COR_SUPPORT_M A  --21
LEFT JOIN COR_PROGRAMLIST_M B ON B.PROGRAMID = A.PROGRAMID  --21
WHERE 1=1
AND A.REQUESTDT BETWEEN REPLACE('2019-05-28', '-', '') AND REPLACE('2019-05-29', '-', '')  --11
AND (A.PROGRAMID = 'PIP0111' OR B.PROGRAMNM LIKE '%교육%' OR A.REQUESTUSER = '관리자' OR A.REQUESTDESC LIKE '%해외%')  --11
AND A.REQUESTUSER = '관리자'  --11                                                                                             -- 나의요청만
AND ISNULL(A.SUPPORTDT, '') = ''  --11                                                                                        -- 미처리건만


----------------------------------------------------------시스템지원관리목록신규-----------------------------------------------------------------------
DECLARE @SEQ INT
SELECT @SEQ = ISNULL(MAX(REQUESTSEQ),0) + 1 FROM COR_SUPPORT_M

INSERT INTO COR_SUPPORT_M (
    REQUESTSEQ                                                                                                                -- 일련번호
  , PROGRAMID                                                                                                                 -- 프로그램아이디
  , REQUESTDT                                                                                                                 -- 요청일
  , REQUESTUSER                                                                                                               -- 요청자
  , REQUESTDESC                                                                                                               -- 요청내용
  , INDT                                                                                                                      -- 입력일
  , INUSER                                                                                                                    -- 입력자
) VALUES (
   @SEQ                                                                                                                       -- 일련번호
, 'SPHJ0001'                                                                                                                  -- 프로그램아이디
, '20190515'                                                                                                                  -- 요청일
, '조한중'                                                                                                                     -- 요청자
, '해외유학생관리문제2'                                                                                                          -- 요청내용
, GETDATE()                                                                                                                   -- 입력일
, 'papi'                                                                                                                      -- 입력자
)


------------------------------------------------------시스템지원관리목록수정-------------------------------------------------------------------------
UPDATE COR_SUPPORT_M SET
    REQUESTDESC                   = '원격접속불가'                                                                              -- 요청내용
  , UPDT                          = GETDATE()                                                                                 -- 입력일
  , UPUSER                        = 'papi'                                                                                    -- 입력자
  , SUPPORTDT                     = '20210722'         -- 이하 처리할때--                                                       -- 처리일
  , SUPPORTUSER                   = 'papi'                                                                                    -- 처리자
  , SUPPORTDESC                   = '컨플루언서에 설명자세하게올려놨습니다'                                                         -- 처리내용
WHERE 1=1
AND REQUESTSEQ = '38'


----------------------------------------------------시스템지원관리목록삭제---------------------------------------------------------------------------
DELETE COR_SUPPORT_M
WHERE 1=1
AND REQUESTSEQ = '38'






-----------------------------------------------------부속기관관리조회-------------------------------------------------------------------------------
-- 부속기관코드,부속기관명,사용여부
SELECT
  A.DAEBUNLYUCD                                                                                                               -- 부속기관코드
, A.PSNM                                                                                                                      -- 부속기관명
, A.USEYN                                                                                                                     -- 사용여부
FROM STB_GWAJEONGCD_M A  --18
WHERE 1=1
AND A.JUNGBUNLYUCD = '$'
AND A.PSNM LIKE '%경영%'






-----------------------------------------------------부속기관관리신규-------------------------------------------------------------------------------
INSERT INTO STB_GWAJEONGCD_M (
  DAEBUNLYUCD                                                                                                                 -- 대분류
, JUNGBUNLYUCD                                                                                                                -- 중분류
, PSNM                                                                                                                        -- 부속기관명
, USEYN                                                                                                                       -- 사용여부
, INUSER                                                                                                                      -- 입력자
, INDT                                                                                                                        -- 입력일시
) VALUES (
  (SELECT CONVERT(VARCHAR,FORMAT(ISNULL(MAX (CONVERT(INT, DAEBUNLYUCD)),0) + 1 , 'D2')) FROM STB_GWAJEONGCD_M WHERE JUNGBUNLYUCD = '$')   -- 대분류
, '$'                                                                                                                         -- 중분류
, 'DD'                                                                                                                        -- 부속기관명
, 'true'                                                                                                                      -- 사용여부
, 'admin'                                                                                                                     -- 입력자
, GETDATE()                                                                                                                   -- 입력일시
)



-----------------------------------------------------부속기관관리수정-------------------------------------------------------------------------------
UPDATE STB_GWAJEONGCD_M SET
  PSNM                         = '효자교육원'                                                                                    -- 부속기관명
, USEYN                        = 'false'                                                                                       -- 사용여부
, UPUSER                       = 'admin'                                                                                       -- 입력자
, UPDT                         = GETDATE()
WHERE 1=1
AND DAEBUNLYUCD = '04' AND JUNGBUNLYUCD = '$'




-----------------------------------------------------부속기관관리삭제-------------------------------------------------------------------------------
DELETE STB_GWAJEONGCD_M
WHERE 1=1
AND DAEBUNLYUCD = '04' AND JUNGBUNLYUCD = '$'



-----------------------------------------------------교육과정코드조회-------------------------------------------------------------------------------
-- 부속기관코드,부속기관명,과정코드,과정명,임명장명,사용여부
SELECT
A.DAEBUNLYUCD                                                                                                                 -- 부속기관코드
, B.PSNM                                                                                                                      -- 부속기관명
, A.JUNGBUNLYUCD                                                                                                              -- 과정코드
, A.PSNM                                                                                                                      -- 과정명
, C.CODENAME                                                                                                                  -- 임명장명
, A.USEYN                                                                                                                     -- 사용여부
FROM STB_GWAJEONGCD_M A  --18
INNER JOIN STB_GWAJEONGCD_M B ON B.JUNGBUNLYUCD ='$' AND B.DAEBUNLYUCD = A.DAEBUNLYUCD  --18
LEFT JOIN COR_BASECODE_M C ON C.GROUPCODE = 'SPS01' AND C.SUBCODE = A.PSGB  --18
WHERE 1=1
AND A.JUNGBUNLYUCD <> '$'
AND A.DAEBUNLYUCD = '01'
AND A.PSNM LIKE '%유통%'




-----------------------------------------------------교육과정코드신규-------------------------------------------------------------------------------
INSERT INTO STB_GWAJEONGCD_M (
  DAEBUNLYUCD                                                                                                                 -- 부속기관코드
, JUNGBUNLYUCD                                                                                                                -- 과정코드
, PSNM                                                                                                                        -- 과정명
, PSGB                                                                                                                        -- 임명장명
, USEYN                                                                                                                       -- 사용여부
, INUSER                                                                                                                      -- 입력자
, INDT                                                                                                                        -- 입력일시
) VALUES (
  '02'
, '02' + (SELECT CONVERT(VARCHAR,FORMAT(ISNULL(MAX (RIGHT((CONVERT(INT, JUNGBUNLYUCD)),2)),0) + 1, 'D2')) FROM STB_GWAJEONGCD_M WHERE JUNGBUNLYUCD <> '$' AND DAEBUNLYUCD = '02')
, '송'
, '1'
, 'false'
, 'admin'
, GETDATE()
)




-----------------------------------------------------교육과정코드수정-------------------------------------------------------------------------------
UPDATE STB_GWAJEONGCD_M SET
  PSNM                         = '여'                                                                                          -- 과정명
, PSGB                         = '2'                                                                                           -- 임명장명
, USEYN                        = 'true'                                                                                        -- 사용여부
, UPUSER                       = 'admin'                                                                                       -- 입력자
, UPDT                         = GETDATE()                                                                                     -- 입력일시
WHERE 1=1
AND DAEBUNLYUCD = '02'
AND JUNGBUNLYUCD = '0204'




-----------------------------------------------------교육과정코드삭제-------------------------------------------------------------------------------
DELETE STB_GWAJEONGCD_M
WHERE 1=1
AND DAEBUNLYUCD = '02'
AND JUNGBUNLYUCD = '0204'




-----------------------------------------------------교육과정개설(기수)조회-------------------------------------------------------------------------------
-- 학년도,학기(기수),부속기관,과정명,개설과정코드,개설과정명,과정시작일,과정종료일,접수시작일,접수종료일,수강료,수료예정일
SELECT
  A.YY-- 학년도
, A.HAGGI-- ,학기(기수)
, C.PSNM-- ,부속기관
, B.PSNM-- ,과정명
, A.GWAJEONGCD-- ,개설과정코드
, A.GWAJEONGNM-- ,개설과정명
, CONVERT(CHAR(10), CONVERT (DATE, A.FRDT )) AS FRDT-- ,과정시작일
, CONVERT(CHAR(10), CONVERT (DATE, A.TODT )) AS TODT-- ,과정종료일
, CONVERT(CHAR(10), CONVERT (DATE, A.JEOBSUFRDT )) AS JEOBSUFRDT-- ,접수시작일
, CONVERT(CHAR(10), CONVERT (DATE, A.JEOBSUTODT )) AS JEOBSUTODT-- ,접수종료일
, FORMAT(A.SUGANGAMT, '#,#') AS SUGANGAMT--수강료
, CONVERT(CHAR(10), CONVERT (DATE, A.SURYODT )) AS SURYODT-- ,수료예정일
FROM STB_GWAJEONG_M A  --23
INNER JOIN STB_GWAJEONGCD_M B ON B.JUNGBUNLYUCD = A.JUNGBUNLYUCD  --23
INNER JOIN STB_GWAJEONGCD_M C ON C.JUNGBUNLYUCD ='$' AND C.DAEBUNLYUCD = A.DAEBUNLYUCD  --23
WHERE 1=1
AND A.YY = '2018'  --2
AND A.HAGGI = '2'  --2
AND A.JUNGBUNLYUCD = '0104'  --1
AND A.GWAJEONGNM LIKE '%노사%'





-----------------------------------------------------교육과정개설(기수)신규-------------------------------------------------------------------------------
INSERT INTO STB_GWAJEONG_M (
  GWAJEONGCD
, GWAJEONGNM
, YY
, HAGGI
, DAEBUNLYUCD
, JUNGBUNLYUCD
, FRDT
, TODT
, SUGANGAMT
, SURYODT
, JEOBSUFRDT
, JEOBSUTODT
, GWAJEONGGAEYO
, INUSER
, INDT
) VALUES (
  (SELECT '0101'+ CONVERT(VARCHAR,FORMAT(ISNULL(MAX (RIGHT((CONVERT(INT, GWAJEONGCD)),4)),0) + 1, 'D4')) FROM STB_GWAJEONG_M WHERE JUNGBUNLYUCD = '0101')   --학년도 중분류씨디+0001
, '2021년 제1기 협동조합경영대학원과정'
, '2021'
, '1'
, '01'
, '0101'
, REPLACE('2021-07-21', '-', '')
, REPLACE('2021-07-28', '-', '')
, REPLACE('100,000,000', ',', '')
, REPLACE('2021-08-28', '-', '')
, REPLACE('2021-05-11', '-', '')
, REPLACE('2021-05-16', '-', '')
, '호롤룰루'
, 'admin'
, GETDATE()
)





-----------------------------------------------------교육과정개설(기수)수정-------------------------------------------------------------------------------
UPDATE STB_GWAJEONG_M SET
  GWAJEONGNM                     = '2022년 제4기 로로롤ㄹ과정'
, YY                             = '2022'
, HAGGI                          = '14'
, DAEBUNLYUCD                    = '03'
, JUNGBUNLYUCD                   = '0301'
, FRDT                           = REPLACE('2021-07-21', '-', '')
, TODT                           = REPLACE('2021-07-28', '-', '')
, SUGANGAMT                      = REPLACE('100,000,000', ',', '')
, SURYODT                        = REPLACE('2021-08-28', '-', '')
, JEOBSUFRDT                     = REPLACE('2021-05-11', '-', '')
, JEOBSUTODT                     = REPLACE('2021-05-16', '-', '')
, GWAJEONGGAEYO                  = '호롤룰루'
, INUSER                         = 'admin'
, INDT                           = GETDATE()
WHERE  GWAJEONGCD = '01010008'  -- 과정CD키가 중분류씨디키+0001부터 증가인데 이건키인데 걍냅두는건가??





-----------------------------------------------------교육과정개성(기수)삭제-------------------------------------------------------------------------------
DELETE STB_GWAJEONG_M
WHERE GWAJEONGCD = '01010008'








-----------------------------------------------------실습기관목록조회-------------------------------------------------------------------------------
--산업체고유번호,산업체명,실습시작일,실습종료일,실습인원
SELECT
  A.SANEOBCHESEQ
, B.SANEOBCHENM
, A.STDT
, A.EDDT
, C.실습인원
FROM SSS_SILSEUBSAN_M A --6
INNER JOIN SIS_SANEOBCHE_M B ON B.SANEOBCHESEQ = A.SANEOBCHESEQ --6
INNER JOIN (
    SELECT  SCNO AS SCNO,COUNT(SCNO) AS 실습인원   FROM SSS_SILSEUBHAG_M WHERE SUDT IS NOT NULL GROUP BY SCNO
    ) AS C ON C.SCNO = A.SCNO
WHERE 1=1
AND A.SSNO = '2'
AND B.SANEOBCHENM LIKE '%농협%'




-----------------------------------------------------실습생근태목록조회-------------------------------------------------------------------------------
--학교에서 2018년1학계하계,2018년1학기동계 이런식으로 현장실습대분류?? 를 만들어 (SSS_SILSEUB_M에저장) --> 산업체가 모집공고를 낸다 (SSS_SILSEUBSAN_M 에 모집공고저장) --> 학생이 원하는회사신청해 (SSS_SILSEUBHAG)
--그다음에 산업체가 원하는학생을 뽑아 (SSS_SILSEUBHAG에 선발일SUDT업데이트) -->선발학생들 일하면서 근태관리해(SSS_SILSEUBHAGCHUL_M)
--일자,요일,학번,성명,학과,근태구분
DECLARE @StartDateTime DATETIME
DECLARE @EndDateTime DATETIME

SET @StartDateTime = (SELECT STDT FROM SSS_SILSEUBSAN_M WHERE SCNO = '1')
SET @EndDateTime = (SELECT EDDT FROM SSS_SILSEUBSAN_M WHERE SCNO = '1');

WITH DateRange(Dates, DateWD) AS
(
  SELECT @StartDateTime as Date, DATEPART(WEEKDAY, @StartDateTime)
  UNION ALL
  SELECT
    DATEADD(d,1,Dates), DATEPART(WEEKDAY, DATEADD(d,1,Dates))
  FROM DateRange A
  WHERE Dates < @EndDateTime
)
--위는 가상테이블만들어서 자동으로 날짜 출력하는것
SELECT
  A.SCNO
, CONVERT(CHAR(10),CONVERT (DATE, Dates )) AS 일자
, (CASE WHEN C.DateWD = '7' THEN '토' WHEN C.DateWD = '1' THEN '일' WHEN C.DateWD = '2' THEN '월' WHEN C.DateWD = '3' THEN '화' WHEN C.DateWD = '4' THEN '수' WHEN C.DateWD = '5' THEN '목' WHEN C.DateWD = '6' THEN '금' END) AS 요일
, A.HAGBEON AS 학번
, B.NM AS 성명
, D.SOSOGNM AS 학과
, F.CODENAME AS 근태구분
FROM SSS_SILSEUBHAG_M A
INNER JOIN SHJ_HAGJEOG_M B ON B.HAGBEON = A.HAGBEON
FULL OUTER JOIN DateRange C ON 1=1
INNER JOIN COR_SOSOGCD_M D ON D.SOSOGCD = B.SOSOGCD
LEFT JOIN SSS_SILSEUBHAGCHUL_M E ON E.SCNO = A.SCNO AND E.SILDT = C.Dates AND E.HAGBEON = B.HAGBEON --60
LEFT JOIN COR_BASECODE_M F ON F.GROUPCODE = 'SSS06' AND F.SUBCODE = E.CHULGB
WHERE 1=1
AND (A.SCNO = '1' AND A.SUDT IS NOT NULL)
AND C.Dates = REPLACE('2019-06-07', '-', '')
ORDER BY C.Dates , A.HAGBEON





-----------------------------------연습.. 위처럼안하고 날짜테이블이 따로있었음 CROSS JOIN 이해하기----------------------------------------------------------
WITH TT AS (
  SELECT
    A.SCNO
  , C.SILDT
  , B.HAGBEON
  FROM SSS_SILSEUBSAN_M A
  CROSS JOIN (  -- 학생목록
    SELECT HAGBEON
    FROM SSS_SILSEUBHAG_M A
    WHERE 1=1
    AND A.SCNO = '1'
    AND ISNULL(SUDT, '') <> ''   -- 선발대상자만
    ) B
  CROSS JOIN (  -- 기간내 날짜
    SELECT DT8 AS SILDT
    FROM COM_CALENDAR_M A
    CROSS JOIN SSS_SILSEUBSAN_M B
    WHERE 1=1
    AND B.SCNO = '1'
    AND A.DT8 BETWEEN '20190601' AND '20190630'
    ) C
  WHERE 1=1
  AND A.SCNO = '1'
)
SELECT
  A.SCNO
, STUFF(STUFF(A.SILDT, 5,0,'-'),8,0,'-') AS SILDT
, DBO.UFCGETWEEKDAY(A.SILDT) AS SOLDTWEEK
, A.HAGBEON
, B.CHULGB
, B.ILJI
, C.NM
, D.SOSOGNM
, C.HAGNYEON
, C.BANGB
, E.CODENAME AS CHULGBNM
FROM TT A
LEFT JOIN SSS_SILSEUBHAGCHUL_M B ON B.SCNO = A.SCNO AND B.SILDT = A.SILDT AND B.HAGBEON = A.HAGBEON
LEFT JOIN SHJ_HAGJEOG_M C ON C.HAGBEON = A.HAGBEON
LEFT JOIN COR_SOSOGCD_M D ON D.SOSOGCD = C.SOSOGCD
LEFT JOIN COR_BASECODE_M E ON E.GROUPCODE = 'SSS06' AND E.SUBCODE = B.CHULGB
WHERE 1=1
AND A.SILDT = '20190603'
ORDER BY A.SCNO, A.SILDT


-----------------------------------------------------실습생근태목록출근,휴무일,결근-------------------------------------------------------------------------------
INSERT INTO SSS_SILSEUBHAGCHUL_M (
  SCNO
, HAGBEON
, SILDT
, CHULGB
, INUSER
, INDT
) VALUES (
  '1'
, '201851209'
, REPLACE('2019-06-03', '-', '')
, '10'  -- 출근:10, 휴일:20, 결근:90
, 'admin'
, GETDATE()
         )


-----------------------------------------------------교육과정별교과과정-개설강좌목록조회-------------------------------------------------------------------------------
-----------------------------------------------------교육과정별 교과목록조회-----------------------------------------------------------------------------------------
-----------------------------------------------------교육과정별 교과목록신규--------------------------------------------------------------------------------------------
-----------------------------------------------------교육과정별 교과목록수정--------------------------------------------------------------------------------------------
-----------------------------------------------------교육과정별 교과목록삭제--------------------------------------------------------------------------------------------
-----------------------------------------------------교육과정별 교과상세--------------------------------------------------------------------------------------------





-----------------------------------------------------학사-수강-출석부-출석입력(pc용)개설강좌목록조회--------------------------------------------------------------------------------------------
--과목코드,과목명,교수명,개설학과,개설학년,분반,학점,교시,수업시간,입력여부,저장시간,수업일자
SELECT
  A.YY
, A.HAGGI
, A.GWAMOGCD
, B.GWAMOGNM
, A.SOSOGCD
, A.HAGNYEON
, A.BUNBAN
, B.DBGB
FROM SSE_GAESEOLGANGJWA_M A
INNER JOIN (
    SELECT
  C.YY
, C.HAGGI
, C.GWAMOGCD
, D.GWAMOGNM
, C.SOSOGCD
, C.HAGNYEON
, C.BUNBAN
, C.DBGB
, LEFT(STRING_AGG(C.GYOSIGB, '-'),2) + RIGHT(STRING_AGG(C.GYOSIGB, '-'),1) AS GYOSI
, COUNT(1) AS SIGAN
FROM SSE_SIGANPYO_D C  --20
INNER JOIN SGG_GYOGWAMOGCODE_M D ON D.GWAMOGCD = C.GWAMOGCD  --20
WHERE C.YY = '2019' AND C.HAGGI = '1' AND C.DBGB ='5'
GROUP BY C.YY , C.HAGGI , C.HAGNYEON , C.BUNBAN , C.GWAMOGCD , C.BUNBAN , C.SOSOGCD , C.DBGB ,  D.GWAMOGNM
    ) B ON B.YY = A.YY AND B.HAGGI = A.HAGGI AND B.HAGNYEON = A.HAGNYEON AND B.BUNBAN = A.BUNBAN AND B.SOSOGCD = A.SOSOGCD AND B.DBGB = '5'

GROUP BY A.YY , A.HAGGI , A.HAGNYEON , A.BUNBAN , A.GWAMOGCD , A.BUNBAN , A.SOSOGCD , B.DBGB, B.GWAMOGNM


--
SELECT
C.YY
, C.HAGGI
, C.GWAMOGCD
, B.GWAMOGNM
, C.SOSOGCD
, B.SOSOGNM
FROM SSE_GAESEOLGANGJWA_M C
INNER JOIN(
                    SELECT
                  A.YY
                , A.HAGGI
                , A.GWAMOGCD
                , B.GWAMOGNM
                , A.SOSOGCD
                , A.HAGNYEON
                , A.BUNBAN
                , A.DBGB
                , F.SOSOGNM
                , LEFT(STRING_AGG(A.GYOSIGB, '-'),2) + RIGHT(STRING_AGG(A.GYOSIGB, '-'),1) AS GYOSI
                , COUNT(1) AS SIGAN
                FROM SSE_SIGANPYO_D A  --20
                INNER JOIN SGG_GYOGWAMOGCODE_M B ON B.GWAMOGCD = A.GWAMOGCD  --20
                INNER JOIN COR_SOSOGCD_M F ON F.SOSOGCD = A.SOSOGCD
                GROUP BY A.YY , A.HAGGI , A.HAGNYEON , A.BUNBAN , A.GWAMOGCD , A.BUNBAN , A.SOSOGCD , A.DBGB , B.GWAMOGNM, F.SOSOGNM
    ) B ON B.YY = C.YY AND B.HAGGI = C.HAGGI AND B.HAGNYEON = C.HAGNYEON AND B.BUNBAN = C.BUNBAN AND B.SOSOGCD = C.SOSOGCD AND B.DBGB = '5'
WHERE 1=1
AND C.YY='2019'
AND C.HAGGI='1'
AND C.SOSOGCD='120'
AND B.DBGB='5'


----
SELECT
  A.YY
, A.HAGGI
, A.GWAMOGCD
, B.GWAMOGNM
, A.SOSOGCD
, C.SOSOGNM
, A.HAGNYEON
, A.BUNBAN
, A.DBGB
, LEFT(STRING_AGG(A.GYOSIGB, '-'),2) + RIGHT(STRING_AGG(A.GYOSIGB, '-'),1) AS GYOSI, COUNT(1) AS SIGAN
FROM SSE_SIGANPYO_D A --10
INNER JOIN SGG_GYOGWAMOGCODE_M B ON B.GWAMOGCD = A.GWAMOGCD --10
INNER JOIN COR_SOSOGCD_M C ON C.SOSOGCD = A.SOSOGCD
WHERE 1=1
AND A.YY='2019'
AND A.HAGGI='1'
AND A.DBGB='5'
AND A.SOSOGCD='120'
GROUP BY A.YY , A.HAGGI , A.HAGNYEON , A.BUNBAN , A.GWAMOGCD , A.BUNBAN , A.SOSOGCD , A.DBGB, B.GWAMOGNM, C.SOSOGNM



--도저히모르겠어 나중에 실력쌓고다시하기
-----------------------------------------------------출석입력(pc용)출석입력학생목록조회--------------------------------------------------------------------------------------------
-----------------------------------------------------출석입력(pc용)개설강좌목록조회--------------------------------------------------------------------------------------------





-----------------------------------------------------학사-수강-학적관리-학적부조회---------------------------------------------------------------------------------------------
--학번,성명,성명(한자/영문),주민등록번호,국적,휴대폰,전화번호,이메일,주소,현주소
--입학전형구분,정원내외구분,입학구분,수험번호,입학일자,추천조합,출신고교,고교졸업일,출신대학명,신입생일련번호
--졸업일자,학위명,학위번호,졸업증서번호,조기졸업여부
--교원자격증번호,교직자격종별,경력
--보호자명,보호자관계,보호자연락처,보호자휴대폰,보호자주소
--군번,제대일,군별/병력구분
SELECT
  A.HAGBEON--학번
, A.NM-- ,성명
, '('+A.NMHAN+ '/'+ A.NMENG1+ ''+A.NMENG2+')' AS [NMHAN/NMENG]
, SUBSTRING(A.JUMINNO,1,6) + '-' + SUBSTRING(A.JUMINNO,7,1) +'*****'-- ,주민등록번호
, DBO.GETCODENM('COR38',A.GUGJEOGGB) AS GUGJEOGGBNM-- ,국적
, B.MOBILE -- ,휴대폰
, B.TELNO-- ,전화번호
, B.EMAIL-- ,이메일
, B.JUSO1
, B.JUSO2-- ,주소
, B.HYEONJUSO1
, B.HYEONJUSO2-- ,현주소
, DBO.GETCODENM('SHJ11',A.IBHAGGB) AS IBHAGGBNM-- ,입학구분
, DBO.GETCODENM('SIS03',A.JEONHYEONGGB) AS JEONHYEONGGBNM--입학전형구분
, DBO.GETCODENM('COR06',A.JEONGWONNAEOEGB) AS JEONGWONNAEOEGBNM-- ,정원내외구분
, A.SUHEOMNO-- ,수험번호
-- ,추천조합--------------------------------------------------------------------------------------------------???????
, C.GOGYONM-- ,출신고교
, DBO.GETDT(A.IBHAGDT) AS IBHAGDT--입학일
, (CASE WHEN GOGYOJEDT != '' AND GOGYOJEDT IS NOT NULL THEN GOGYOJEDT  ELSE '' END) AS GOGYOJEDT-- ,고교졸업일
, C.BFDAEHAGGYONM-- ,출신대학명
-- ,신입생일련번호---------------------------------------------------------------------------------------------????????
, DBO.GETDT(A.JOLEOBDT) AS JOLEOBDT-- ,졸업일자
, DBO.GETCODENM('COR21',A.SOSOGHAGWIGB) AS SOSOGHAGWIGB-- ,학위명
, A.HAGWINO-- ,학위번호
, A.JEJEUNGSEONO-- ,졸업증서번호
, A.JOGIJEYN-- ,조기졸업여부
, A.GYOWONNO--교원자격증번호
, DBO.GETCODENM('SGJ01',A.JAGYEOGGB) AS JAGYEOGGB-- ,교직자격종별
, D.GYEONGLYEOG-- ,경력
, B.BOHOJANM--보호자명
, B.BOHOJAGWANGE-- ,보호자관계
, B.BOHOJATEL-- ,보호자연락처
, B.BOHOJAMOBILE-- ,보호자휴대폰
, B.BOHOJAJUSO1
, B.BOHOJAJUSO2-- ,보호자주소
, A.GUNBEON--군번
, DBO.GETDT(A.JEDAEDT) AS JEDAEDT-- ,제대일
, DBO.GETCODENM('SBM04',A.GUNBYEOLGB) AS JEONGWONNAEOEGBNM
, DBO.GETCODENM('SHJ02',A.BYEONGLYEOGGB) AS JEONGWONNAEOEGBNM-- ,군별/병력구분
FROM SHJ_HAGJEOG_M AS A  --6396
LEFT JOIN SHJ_JUSO_D B ON B.HAGBEON = A.HAGBEON  --6396
LEFT JOIN SHJ_JEONJEOGHAGGYO_D C ON C.HAGBEON = A.HAGBEON  --6396
LEFT JOIN (
  SELECT
    a.HAGBEON
  , STRING_AGG(b.SANEOBCHENM +'('+ a.YY +'년'+a.HAGGI+'학기'+')', ',') GYEONGLYEOG
  FROM SHJ_JAEJIKSANEOBCHE_H a --1164
  INNER JOIN SIS_SANEOBCHE_M B ON B.SANEOBCHESEQ = A.SANEOBCHECD  --1164
  GROUP BY HAGBEON
    ) D ON D.HAGBEON = A.HAGBEON  --6396
--WHERE (A.HAGBEON = '200911131' OR A.NM = '기오두')
WHERE A.HAGBEON = '200911131'


-----------------------------------------------------부속시설-평생교육원-교육신청-교육과정수강신청---------------------------------------------------------------------------------------------
--학년도,학기(기수),부속기관,과정명,개설과정코드,개설과정명,과정시작일,과정종료일,접수시작일,접수종료일,수강료,신청일
SELECT
  A.YY                                                               --  학년도
, A.HAGGI                                                            -- ,학기(기수)
, C.PSNM                                  AS BUSOGNM                 -- ,부속기관
, B.PSNM                                  AS GWAJEONGNM              -- ,과정명
, A.GWAJEONGCD                                                       -- ,개설과정코드
, A.GWAJEONGNM                                                       -- ,개설과정명
, DBO.GETDT(A.FRDT)                 AS FRDT                     -- ,과정시작일
, DBO.GETDT(A.TODT)                 AS TODT                     -- ,과정종료일
, DBO.GETDT(A.JEOBSUFRDT)           AS JEOBSUFRDT               -- ,접수시작일
, DBO.GETDT(A.JEOBSUTODT)           AS JEOBSUTODT               -- ,접수종료일
, FORMAT(A.SUGANGAMT, '#,#0')            AS SUGANGAMT                            -- ,수강료
FROM STB_GWAJEONG_M A  --24
INNER JOIN STB_GWAJEONGCD_M B ON B.JUNGBUNLYUCD = A.JUNGBUNLYUCD
INNER JOIN STB_GWAJEONGCD_M C ON C.JUNGBUNLYUCD ='$' AND C.DAEBUNLYUCD = A.DAEBUNLYUCD  --24
WHERE 1=1
AND A.YY = '2018'
AND A.HAGGI = '2'
AND (A.DAEBUNLYUCD = LEFT('0104',2) AND A.JUNGBUNLYUCD = '0104')
AND A.GWAJEONGNM LIKE '%노사%'



-------------------------------------------------학생이력-상담관리-면담결과관리------------------------------------------------
--상태,상담구분,학번,성명,학과,상담일,상담자,요청내용,상담내용,비공개,온라인
SELECT
  (CASE WHEN (A.NAEYONG <> '' AND A.NAEYONG IS NOT NULL) THEN '완료' ELSE '예약' END) AS SANGTAE--상태
, DBO.GETCODENM('005',A.JINHAENGGB) AS SANGDAMGB-- ,상담구분
, A.HAGBEON-- ,학번
, B.NM-- ,성명
, C.SOSOGNM-- ,학과
, DBO.GETDT(A.JINHAENGDT)-- ,상담일
, A.JINHAENGJA-- ,상담자
, D.USERNM
, A.REQNAEYONG-- ,요청내용
, A.NAEYONG-- ,상담내용
, A.BIGONGGAEYN-- ,비공개
, A.ONLINEYN-- ,온라인
FROM SCE_JINHAENG_M A  --3
INNER JOIN SHJ_HAGJEOG_M B ON B.HAGBEON = A.HAGBEON  --3
INNER JOIN COR_SOSOGCD_M C ON C.SOSOGCD = B.SOSOGCD  --3
LEFT JOIN COR_USER_M D ON D.USERID = A.JINHAENGJA
WHERE 1=1
AND A.JINHAENGDT BETWEEN REPLACE('2019-01-01','-','') AND REPLACE('2021-08-04','-','')
AND A.JINHAENGJA = 'papi'
AND (A.TIMEGB IS NOT NULL AND A.TIMEGB <> '')


-----------------------------------------------------------학생이력-학생이력관리-학생이력(자격증)----------------------------------------
--상태,이력구분,분류,제목,기관,취득일,증빙여부,마일리지
SELECT
  (CASE WHEN A.SEUNGDT IS NOT NULL THEN '승인' ELSE '승인대기' END) AS SANGTAE--상태
, DBO.GETCODENM('SHE11',A.BUNYAGB) AS IRYEOKGBNM-- ,이력구분
, DBO.GETCODENM('SHE12',A.BUNYADGB) AS BUNRYU -- ,분류
, A.PROGRAMNM-- ,제목
, A.GIGWAN-- ,기관
, CONVERT(CHAR(10), CONVERT (DATE, A.SINDT )) AS SINDT-- ,취득일
, (CASE WHEN A.FILEPATH IS NOT NULL THEN 'Y' ELSE 'N' END) AS JUNGBING-- ,증빙여부
, A.MILEAGE-- ,마일리지
FROM SHS_IRYEOK_M A --8
WHERE 1=1
AND A.BUNYAGB ='10'
AND A.SINDT BETWEEN REPLACE('2019-01-01','-','') AND REPLACE('2021-08-04','-','')

----------------------------------------------------
--신청연도,자격증구분,신청자수,승인자수
SELECT
  LEFT(A.SINDT ,4) AS SINYY-- 신청년도
, DBO.GETCODENM('SHE12',A.BUNYADGB) AS BUNRYU-- 자격증구분
, COUNT(A.SINDT) AS SINSU-- 신청자수
, COUNT(A.SEUNGDT) AS SUNSU-- 승인자수
FROM SHS_IRYEOK_M A
WHERE A.BUNYAGB='10'
GROUP BY LEFT(A.SINDT,4) , A.BUNYADGB HAVING COUNT(A.BUNYADGB) > 1



-------------------------------------------------------동아리활동학생--------------------------------------------------------------------
SELECT
  A.YY
, A.DONGALICD
, B.DONGALINM
, C.NM
, A.JIGCHAEGGB
, DBO.GETCODENM('SHS05',A.JIGCHAEGGB) AS JIGCHAEGGBNM
, D.CODENAME
FROM SHS_DONGALI_D A --1281
INNER JOIN SHS_DONGALI_M B ON B.DONGALICD = A.DONGALICD  --1281
INNER JOIN SHJ_HAGJEOG_M C ON C.HAGBEON = A.HAGBEON  --1281
LEFT JOIN COR_BASECODE_M D ON D.GROUPCODE='SHS05' AND D.SUBCODE=A.JIGCHAEGGB
WHERE A.YY='2014'
ORDER BY A.JIGCHAEGGB



